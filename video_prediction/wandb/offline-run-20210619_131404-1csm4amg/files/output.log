Training Dataset Shapes: (8000, 19, 64, 64, 1), (8000, 19, 64, 64, 1)
Validation Dataset Shapes: (2000, 19, 64, 64, 1), (2000, 19, 64, 64, 1)
Epoch 1/20
1600/1600 [==============================] - 523s 314ms/step - loss: 0.0512 - val_loss: 0.0248
Epoch 2/20
1600/1600 [==============================] - 499s 312ms/step - loss: 0.0246 - val_loss: 0.0242
Epoch 3/20
1600/1600 [==============================] - 499s 312ms/step - loss: 0.0240 - val_loss: 0.0239
Epoch 4/20
1600/1600 [==============================] - 499s 312ms/step - loss: 0.0238 - val_loss: 0.0237
Epoch 5/20
1600/1600 [==============================] - 499s 312ms/step - loss: 0.0237 - val_loss: 0.0236
Epoch 6/20
1600/1600 [==============================] - 500s 313ms/step - loss: 0.0235 - val_loss: 0.0237
Epoch 7/20
1600/1600 [==============================] - 501s 313ms/step - loss: 0.0235 - val_loss: 0.0234
Epoch 8/20
1600/1600 [==============================] - 501s 313ms/step - loss: 0.0235 - val_loss: 0.0236
Epoch 9/20
1600/1600 [==============================] - 501s 313ms/step - loss: 0.0233 - val_loss: 0.0233
Epoch 10/20
1600/1600 [==============================] - 500s 313ms/step - loss: 0.0233 - val_loss: 0.0233
Epoch 11/20
1600/1600 [==============================] - 500s 313ms/step - loss: 0.0232 - val_loss: 0.0233
Epoch 12/20
1600/1600 [==============================] - 501s 313ms/step - loss: 0.0232 - val_loss: 0.0232
Epoch 13/20
1600/1600 [==============================] - 501s 313ms/step - loss: 0.0231 - val_loss: 0.0232
Epoch 14/20
1600/1600 [==============================] - 501s 313ms/step - loss: 0.0230 - val_loss: 0.0230
Epoch 15/20
1600/1600 [==============================] - 501s 313ms/step - loss: 0.0229 - val_loss: 0.0231
Epoch 16/20
1600/1600 [==============================] - 499s 312ms/step - loss: 0.0230 - val_loss: 0.0231
Epoch 17/20
1600/1600 [==============================] - 500s 312ms/step - loss: 0.0229 - val_loss: 0.0230
Epoch 18/20
1600/1600 [==============================] - 500s 313ms/step - loss: 0.0230 - val_loss: 0.0230
Epoch 19/20
1600/1600 [==============================] - 500s 313ms/step - loss: 0.0228 - val_loss: 0.0230
Epoch 20/20
1600/1600 [==============================] - 500s 313ms/step - loss: 0.0226 - val_loss: 0.0228
2021-06-19 13:14:16.263616: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-19 13:14:16.269205: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-06-19 13:14:16.318411: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:1a:00.0 name: Tesla V100-SXM2-16GB computeCapability: 7.0
coreClock: 1.53GHz coreCount: 80 deviceMemorySize: 15.78GiB deviceMemoryBandwidth: 836.37GiB/s
2021-06-19 13:14:16.318592: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-19 13:14:16.333918: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-19 13:14:16.334188: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-19 13:14:16.339078: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-19 13:14:16.340946: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-19 13:14:16.348832: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-19 13:14:16.350344: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-19 13:14:16.351241: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-19 13:14:16.370639: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-06-19 13:14:16.375349: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-06-19 13:14:16.375766: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-06-19 13:14:16.376640: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:1a:00.0 name: Tesla V100-SXM2-16GB computeCapability: 7.0
coreClock: 1.53GHz coreCount: 80 deviceMemorySize: 15.78GiB deviceMemoryBandwidth: 836.37GiB/s
2021-06-19 13:14:16.376660: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-19 13:14:16.376670: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-19 13:14:16.376678: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-19 13:14:16.376685: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-19 13:14:16.376693: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-19 13:14:16.376700: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-06-19 13:14:16.376707: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-19 13:14:16.376715: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-19 13:14:16.378225: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-06-19 13:14:16.378897: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-19 13:14:18.739956: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-19 13:14:18.739978: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0
2021-06-19 13:14:18.739984: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N
2021-06-19 13:14:18.748564: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 14759 MB memory) -> physical GPU (device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:1a:00.0, compute capability: 7.0)
2021-06-19 13:14:19.605407: I tensorflow/core/profiler/lib/profiler_session.cc:136] Profiler session initializing.
2021-06-19 13:14:19.605428: I tensorflow/core/profiler/lib/profiler_session.cc:155] Profiler session started.
2021-06-19 13:14:19.605458: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1365] Profiler found 1 GPUs
2021-06-19 13:14:19.607626: W tensorflow/stream_executor/platform/default/dso_loader.cc:60] Could not load dynamic library 'libcupti.so.11.0'; dlerror: libcupti.so.11.0: cannot open shared object file: No such file or directory
2021-06-19 13:14:19.608794: W tensorflow/stream_executor/platform/default/dso_loader.cc:60] Could not load dynamic library 'libcupti.so'; dlerror: libcupti.so: cannot open shared object file: No such file or directory
2021-06-19 13:14:19.608821: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1415] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-06-19 13:14:19.608848: I tensorflow/core/profiler/lib/profiler_session.cc:172] Profiler session tear down.
2021-06-19 13:14:19.608867: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1496] function cupti_interface_->Finalize()failed with error CUPTI could not be loaded or symbol could not be found.
2021-06-19 13:14:23.581392: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-06-19 13:14:23.589982: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2400000000 Hz
2021-06-19 13:14:28.357661: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:592] layout failed: Invalid argument: MutableGraphView::SortTopologically error: detected edge(s) creating cycle(s) {'Func/gradient_tape/model/conv_lst_m2d_1/while/model/conv_lst_m2d_1/while_grad/body/_725/input/_1603' -> 'gradient_tape/model/conv_lst_m2d_1/while/model/conv_lst_m2d_1/while_grad/body/_725/gradient_tape/model/conv_lst_m2d_1/while/gradients/AddN', 'Func/gradient_tape/model/conv_lst_m2d/while/model/conv_lst_m2d/while_grad/body/_915/input/_1717' -> 'gradient_tape/model/conv_lst_m2d/while/model/conv_lst_m2d/while_grad/body/_915/gradient_tape/model/conv_lst_m2d/while/gradients/AddN', 'model/conv_lst_m2d_2/while/body/_357/model/conv_lst_m2d_2/while/mul_2' -> 'model/conv_lst_m2d_2/while/body/_357/model/conv_lst_m2d_2/while/add_5', 'model/conv_lst_m2d_2/while/body/_357/model/conv_lst_m2d_2/while/clip_by_value_2' -> 'model/conv_lst_m2d_2/while/body/_357/model/conv_lst_m2d_2/while/mul_5', 'model/conv_lst_m2d_2/while/body/_357/model/conv_lst_m2d_2/while/convolution_6' -> 'model/conv_lst_m2d_2/while/body/_357/model/conv_lst_m2d_2/while/add_4', 'model/conv_lst_m2d_2/while/body/_357/model/conv_lst_m2d_2/while/clip_by_value' -> 'model/conv_lst_m2d_2/while/body/_357/model/conv_lst_m2d_2/while/mul_3', 'Func/gradient_tape/model/conv_lst_m2d_2/while/model/conv_lst_m2d_2/while_grad/body/_535/input/_1487' -> 'gradient_tape/model/conv_lst_m2d_2/while/model/conv_lst_m2d_2/while_grad/body/_535/gradient_tape/model/conv_lst_m2d_2/while/gradients/AddN', 'model/conv_lst_m2d_1/while/body/_179/model/conv_lst_m2d_1/while/clip_by_value' -> 'model/conv_lst_m2d_1/while/body/_179/model/conv_lst_m2d_1/while/mul_3', 'model/conv_lst_m2d_1/while/body/_179/model/conv_lst_m2d_1/while/convolution_6' -> 'model/conv_lst_m2d_1/while/body/_179/model/conv_lst_m2d_1/while/add_4', 'model/conv_lst_m2d_1/while/body/_179/model/conv_lst_m2d_1/while/mul_2' -> 'model/conv_lst_m2d_1/while/body/_179/model/conv_lst_m2d_1/while/add_5', 'model/conv_lst_m2d_1/while/body/_179/model/conv_lst_m2d_1/while/clip_by_value_2' -> 'model/conv_lst_m2d_1/while/body/_179/model/conv_lst_m2d_1/while/mul_5', 'model/conv_lst_m2d/while/body/_1/model/conv_lst_m2d/while/mul_5' -> 'model/conv_lst_m2d/while/body/_1/model/conv_lst_m2d/while/Identity_4', 'model/conv_lst_m2d/while/body/_1/model/conv_lst_m2d/while/mul_2' -> 'model/conv_lst_m2d/while/body/_1/model/conv_lst_m2d/while/add_5'}.
2021-06-19 13:14:28.999784: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-19 13:14:31.146512: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2021-06-19 13:14:31.201792: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output:
Relying on driver to perform ptx compilation.
Modify $PATH to customize ptxas location.
This message will be only logged once.
2021-06-19 13:14:32.537887: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-19 13:14:32.922284: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-06-19 13:14:45.687992: I tensorflow/core/profiler/lib/profiler_session.cc:136] Profiler session initializing.
2021-06-19 13:14:45.688015: I tensorflow/core/profiler/lib/profiler_session.cc:155] Profiler session started.
2021-06-19 13:14:45.688052: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1415] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.
2021-06-19 13:14:45.993136: I tensorflow/core/profiler/lib/profiler_session.cc:71] Profiler session collecting data.
2021-06-19 13:14:45.993304: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1496] function cupti_interface_->Finalize()failed with error CUPTI could not be loaded or symbol could not be found.
2021-06-19 13:14:46.058789: I tensorflow/core/profiler/internal/gpu/cupti_collector.cc:228]  GpuTracer has collected 0 callback api events and 0 activity events.
2021-06-19 13:14:46.077279: I tensorflow/core/profiler/lib/profiler_session.cc:172] Profiler session tear down.
2021-06-19 13:14:46.110941: I tensorflow/core/profiler/rpc/client/save_profile.cc:137] Creating directory: /lustre03/project/6058211/pranaval/ODE-RL/video_prediction/wandb/offline-run-20210619_131404-1csm4amg/files/train/plugins/profile/2021_06_19_13_14_46
2021-06-19 13:14:46.115890: I tensorflow/core/profiler/rpc/client/save_profile.cc:143] Dumped gzipped tool data for trace.json.gz to /lustre03/project/6058211/pranaval/ODE-RL/video_prediction/wandb/offline-run-20210619_131404-1csm4amg/files/train/plugins/profile/2021_06_19_13_14_46/blg5708.int.ets1.calculquebec.ca.trace.json.gz
2021-06-19 13:14:46.175767: I tensorflow/core/profiler/rpc/client/save_profile.cc:137] Creating directory: /lustre03/project/6058211/pranaval/ODE-RL/video_prediction/wandb/offline-run-20210619_131404-1csm4amg/files/train/plugins/profile/2021_06_19_13_14_46
2021-06-19 13:14:46.206509: I tensorflow/core/profiler/rpc/client/save_profile.cc:143] Dumped gzipped tool data for memory_profile.json.gz to /lustre03/project/6058211/pranaval/ODE-RL/video_prediction/wandb/offline-run-20210619_131404-1csm4amg/files/train/plugins/profile/2021_06_19_13_14_46/blg5708.int.ets1.calculquebec.ca.memory_profile.json.gz
2021-06-19 13:14:46.231543: I tensorflow/core/profiler/rpc/client/capture_profile.cc:251] Creating directory: /lustre03/project/6058211/pranaval/ODE-RL/video_prediction/wandb/offline-run-20210619_131404-1csm4amg/files/train/plugins/profile/2021_06_19_13_14_46Dumped tool data for xplane.pb to /lustre03/project/6058211/pranaval/ODE-RL/video_prediction/wandb/offline-run-20210619_131404-1csm4amg/files/train/plugins/profile/2021_06_19_13_14_46/blg5708.int.ets1.calculquebec.ca.xplane.pb
Dumped tool data for overview_page.pb to /lustre03/project/6058211/pranaval/ODE-RL/video_prediction/wandb/offline-run-20210619_131404-1csm4amg/files/train/plugins/profile/2021_06_19_13_14_46/blg5708.int.ets1.calculquebec.ca.overview_page.pb
Dumped tool data for input_pipeline.pb to /lustre03/project/6058211/pranaval/ODE-RL/video_prediction/wandb/offline-run-20210619_131404-1csm4amg/files/train/plugins/profile/2021_06_19_13_14_46/blg5708.int.ets1.calculquebec.ca.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to /lustre03/project/6058211/pranaval/ODE-RL/video_prediction/wandb/offline-run-20210619_131404-1csm4amg/files/train/plugins/profile/2021_06_19_13_14_46/blg5708.int.ets1.calculquebec.ca.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to /lustre03/project/6058211/pranaval/ODE-RL/video_prediction/wandb/offline-run-20210619_131404-1csm4amg/files/train/plugins/profile/2021_06_19_13_14_46/blg5708.int.ets1.calculquebec.ca.kernel_stats.pb
WARNING:tensorflow:Callback method `on_train_batch_end` is slow compared to the batch time (batch time: 0.2507s vs `on_train_batch_end` time: 0.3381s). Check your callbacks.
[34m[1mwandb[39m[22m: [33mWARNING[39m When using several event log directories, please call wandb.tensorboard.patch(root_logdir="...") before wandb.init
2021-06-19 13:22:29.342826: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:592] layout failed: Invalid argument: MutableGraphView::SortTopologically error: detected edge(s) creating cycle(s) {'model/conv_lst_m2d_2/while/body/_97/model/conv_lst_m2d_2/while/Relu_1' -> 'model/conv_lst_m2d_2/while/body/_97/model/conv_lst_m2d_2/while/mul_5', 'Func/model/conv_lst_m2d_2/while/body/_97/input/_240' -> 'model/conv_lst_m2d_2/while/body/_97/model/conv_lst_m2d_2/while/mul_2', 'model/conv_lst_m2d_2/while/body/_97/model/conv_lst_m2d_2/while/convolution_7' -> 'model/conv_lst_m2d_2/while/body/_97/model/conv_lst_m2d_2/while/add_6', 'model/conv_lst_m2d_1/while/body/_49/model/conv_lst_m2d_1/while/mul_2' -> 'model/conv_lst_m2d_1/while/body/_49/model/conv_lst_m2d_1/while/add_5', 'model/conv_lst_m2d_1/while/body/_49/model/conv_lst_m2d_1/while/clip_by_value_2' -> 'model/conv_lst_m2d_1/while/body/_49/model/conv_lst_m2d_1/while/mul_5', 'model/conv_lst_m2d_1/while/body/_49/model/conv_lst_m2d_1/while/clip_by_value' -> 'model/conv_lst_m2d_1/while/body/_49/model/conv_lst_m2d_1/while/mul_3', 'model/conv_lst_m2d_1/while/body/_49/model/conv_lst_m2d_1/while/convolution_6' -> 'model/conv_lst_m2d_1/while/body/_49/model/conv_lst_m2d_1/while/add_4', 'Func/model/conv_lst_m2d/while/body/_1/input/_164' -> 'model/conv_lst_m2d/while/body/_1/model/conv_lst_m2d/while/mul_2', 'model/conv_lst_m2d/while/body/_1/model/conv_lst_m2d/while/mul_5' -> 'model/conv_lst_m2d/while/body/_1/model/conv_lst_m2d/while/Identity_4'}.
WARNING:root:Converting video data to uint8
 91% 10/11 [00:00<00:00, 225.81it/s]
WARNING:root:Converting video data to uint8
 91% 10/11 [00:00<00:00, 607.69it/s]